package org.jsmith.mvc.controller.command{	import flash.events.Event;		import org.jsmith.mvc.controller.command.ICommand;	import org.jsmith.mvc.error.*;
	import org.jsmith.mvc.events.MVCEvent;		/**	 * 	Dispatched when an <code>ICommand</code> instance progresses.	 * 	 * 	@see org.jsmith.mvc.controller.command.ICommand	 */	[Event(name="commandProgress", type="org.jsmith.mvc.events.MVCEvent.COMMAND_PROGRESS")]		public class CompoundCommand extends Command implements ICommand, ICommandProgress	{		public override function get percentComplete():Number		{			var _percentComplete:Number = -1;						for(var i:int=0;i<_commands.length;i++)			{				var c:ICommandProgress  = _commands[i] as ICommandProgress;								if(c.percentComplete == -1)					continue;								if(_percentComplete == -1)					_percentComplete = 0;									_percentComplete += c.percentComplete;								}//end for						if(_percentComplete != -1)				_percentComplete /= _commands.length;						return _percentComplete;					}//end property				public function get commandsCompleted():int { return _commandsCompleted; }		private var _commandsCompleted:int;				public function get commandsTotal():int { return _commands.length; }		protected var event:Event;				private var _commands:Array;				public function CompoundCommand()		{			_commands = new Array();			_commandsCompleted = 0;					}//end constructor			public function add(command:ICommand):void		{			_commands.push(command);					}//end method				public function remove(command:ICommand):void		{			var i:int = _commands.indexOf(command);			if(i < 0)				return;							_commands.splice(i,1);					}//end method				public override function execute(event:Event = null):void		{			this.event = event;						if(_commands.length < 1)				throw new MVCError(MVCErrorCodes.COMMAND_EMPTY);						for( var i:Number=0;i<_commands.length;i++) 			{				var c:Command = _commands[i] as Command;				c.addEventListener(MVCEvent.COMMAND_PROGRESS, onCommandProgress);				c.addEventListener(Event.COMPLETE, onCommandComplete);				c.execute(event);						}//end for					}//end method				private function onCommandProgress(e:MVCEvent):void		{			onProgress();					}//end method				private function onCommandComplete(e:Event):void		{			_commandsCompleted++;						onProgress();						if(_commandsCompleted == _commands.length)				onComplete();					}//end method			}//end class	}//end package